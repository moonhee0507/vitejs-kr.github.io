import{_ as s,c as n,o as a,a as l}from"./app.75be179e.js";const A=JSON.parse('{"title":"\uC11C\uBC84 \uCE21 \uB80C\uB354\uB9C1 (SSR)","description":"","frontmatter":{"title":"\uC11C\uBC84 \uCE21 \uB80C\uB354\uB9C1 (SSR)"},"headers":[{"level":2,"title":"\uC608\uC81C \uD504\uB85C\uC81D\uD2B8","slug":"example-projects"},{"level":2,"title":"\uD504\uB85C\uC81D\uD2B8 \uAD6C\uC870","slug":"source-structure"},{"level":2,"title":"\uC870\uAC74\uBD80 \uB17C\uB9AC","slug":"conditional-logic"},{"level":2,"title":"\uAC1C\uBC1C \uC11C\uBC84 \uAD6C\uC131\uD558\uAE30","slug":"setting-up-the-dev-server"},{"level":2,"title":"\uD504\uB85C\uB355\uC158 \uBE4C\uB4DC","slug":"building-for-production"},{"level":2,"title":"\uC0AC\uC804 \uB85C\uB4DC\uB420 \uC9C0\uC2DC\uBB38 \uC0DD\uC131\uD558\uAE30","slug":"generating-preload-directives"},{"level":2,"title":"\uC0AC\uC804 \uB80C\uB354\uB9C1 / SSG","slug":"pre-rendering-ssg"},{"level":2,"title":"SSR \uC678\uBD80\uD654","slug":"ssr-externals"},{"level":2,"title":"SSR \uC804\uC6A9 \uD50C\uB7EC\uADF8\uC778 \uB85C\uC9C1","slug":"ssr-specific-plugin-logic"},{"level":2,"title":"SSR \uD0C0\uAC9F","slug":"ssr-target"},{"level":2,"title":"SSR \uBC88\uB4E4","slug":"ssr-bundle"},{"level":2,"title":"Vite CLI","slug":"vite-cli"},{"level":2,"title":"SSR Format","slug":"ssr-format"}],"relativePath":"guide/ssr.md"}'),e={name:"guide/ssr.md"},p=l(`<h1 id="server-side-rendering" tabindex="-1">\uC11C\uBC84 \uCE21 \uB80C\uB354\uB9C1 (SSR) <a class="header-anchor" href="#server-side-rendering" aria-hidden="true">#</a></h1><div class="tip custom-block"><p class="custom-block-title">\uCC38\uACE0</p><p>SSR\uC740 \uB3D9\uC77C\uD55C \uC804\uCCB4 \uC0AC\uC774\uD2B8\uB97C Node.js\uC5D0\uC11C \uB3D9\uC791\uC2DC\uD0A4\uACE0, \uC774\uB97C HTML\uB85C \uC0AC\uC804 \uB80C\uB354\uB9C1 \uD55C \uD6C4, \uB9C8\uC9C0\uB9C9\uC73C\uB85C \uC774\uB97C \uD074\uB77C\uC774\uC5B8\uD2B8\uC758 \uD504\uB7F0\uD2B8\uC5D4\uB4DC \uD504\uB808\uC784\uC6CC\uD06C(\uAC00\uB839 React, Preact, Vue \uBC0F Svelte\uC640 \uAC19\uC740)\uC5D0\uC11C \uAC00\uC838\uC624\uB3C4\uB85D \uD558\uB294 \uAE30\uB2A5\uC785\uB2C8\uB2E4. \uB9CC\uC57D \uAE30\uC874\uC5D0 \uC0AC\uC6A9\uD558\uACE0 \uC788\uC5C8\uB358 \uC11C\uBC84 \uC0AC\uC774\uB4DC \uD504\uB808\uC784\uC6CC\uD06C\uC640\uC758 \uC5F0\uB3D9\uC744 \uC6D0\uD55C\uB2E4\uBA74 <a href="./backend-integration.html">\uBC31\uC5D4\uB4DC \uD504\uB808\uC784\uC6CC\uD06C\uC640 \uD568\uAED8 \uC0AC\uC6A9\uD558\uAE30</a>\uB97C \uCC38\uACE0\uD558\uC2DC\uAE30 \uBC14\uB78D\uB2C8\uB2E4.</p><p>\uB610\uD55C, \uC544\uB798\uC758 \uAC00\uC774\uB4DC\uB294 \uC120\uD0DD\uD55C \uD504\uB808\uC784\uC6CC\uD06C\uC5D0\uC11C SSR\uC744 \uC801\uC6A9\uD574 \uBCF4\uC558\uB2E4\uACE0 \uAC00\uC815\uD558\uBA70, Vite\uC5D0\uC11C\uB294 \uC774\uB97C \uC5B4\uB5BB\uAC8C \uC801\uC6A9\uD560 \uC218 \uC788\uB294\uC9C0\uC5D0 \uB300\uD55C \uC138\uBD80 \uC815\uBCF4\uC5D0\uB9CC \uCD08\uC810\uC744 \uB9DE\uCD94\uC5C8\uC2B5\uB2C8\uB2E4.</p></div><div class="warning custom-block"><p class="custom-block-title">\uC800\uC218\uC900 API</p><p>\uC774 \uB0B4\uC6A9\uC740 \uB77C\uC774\uBE0C\uB7EC\uB9AC \uBC0F \uD504\uB808\uC784\uC6CC\uD06C \uAC1C\uBC1C\uC790\uB4E4\uC744 \uC704\uD55C \uC800\uC218\uC900 API \uC785\uB2C8\uB2E4. \uB9CC\uC57D \uC77C\uBC18\uC801\uC778 \uC560\uD50C\uB9AC\uCF00\uC774\uC158\uC744 \uB9CC\uB4DC\uB294 \uAC83\uC774 \uBAA9\uC801\uC774\uB77C\uBA74, \uBA3C\uC800 <a href="https://github.com/vitejs/awesome-vite#ssr" target="_blank" rel="noopener noreferrer">Awesome Vite SSR</a>\uC5D0\uC11C SSR \uD50C\uB7EC\uADF8\uC778\uACFC \uAD00\uB828 \uD234\uC744 \uD655\uC778\uD574\uC8FC\uC138\uC694. Vite\uC758 \uC800\uC218\uC900\uC758 \uB124\uC774\uD2F0\uBE0C API \uAE30\uBC18\uC73C\uB85C \uB9CE\uC740 \uC218\uC758 \uD504\uB85C\uC81D\uD2B8\uB4E4\uC774 \uC131\uACF5\uC801\uC73C\uB85C \uAD6C\uCD95\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4.</p></div><div class="tip custom-block"><p class="custom-block-title">Help</p><p>\uB9CC\uC57D \uC9C8\uBB38\uD558\uACE0\uC790 \uD55C\uB2E4\uBA74, <a href="https://discord.gg/PkbxgzPhJv" target="_blank" rel="noopener noreferrer">Vite Discord\uC758 #ssr \uCC44\uB110</a>\uC744 \uBC29\uBB38\uD574\uC8FC\uC138\uC694.</p></div><h2 id="example-projects" tabindex="-1">\uC608\uC81C \uD504\uB85C\uC81D\uD2B8 <a class="header-anchor" href="#example-projects" aria-hidden="true">#</a></h2><p>Vite\uB294 \uC11C\uBC84 \uCE21 \uB80C\uB354\uB9C1(SSR, Server-side Rendering)\uC744 \uAE30\uBCF8\uC801\uC73C\uB85C \uC9C0\uC6D0\uD569\uB2C8\uB2E4. Vite \uD50C\uB808\uC774\uADF8\uB77C\uC6B4\uB4DC\uC5D0\uC11C\uB294 SSR \uC124\uC815\uC5D0 \uB300\uD55C Vue 3 \uBC0F React \uC608\uC81C\uB97C \uC81C\uACF5\uD558\uACE0 \uC788\uC73C\uBA70, \uC774\uB97C \uCC38\uACE0\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p><ul><li><a href="https://github.com/vitejs/vite-plugin-vue/tree/main/playground/ssr-vue" target="_blank" rel="noopener noreferrer">Vue 3</a></li><li><a href="https://github.com/vitejs/vite-plugin-react/tree/main/playground/ssr-react" target="_blank" rel="noopener noreferrer">React</a></li></ul><h2 id="source-structure" tabindex="-1">\uD504\uB85C\uC81D\uD2B8 \uAD6C\uC870 <a class="header-anchor" href="#source-structure" aria-hidden="true">#</a></h2><p>\uC77C\uBC18\uC801\uC73C\uB85C SSR \uC560\uD50C\uB9AC\uCF00\uC774\uC158\uC758 \uD504\uB85C\uC81D\uD2B8 \uAD6C\uC870\uB294 \uB2E4\uC74C\uACFC \uAC19\uC2B5\uB2C8\uB2E4:</p><div class="language-"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">- index.html</span></span>
<span class="line"><span style="color:#A6ACCD;">- server.js # main application server</span></span>
<span class="line"><span style="color:#A6ACCD;">- src/</span></span>
<span class="line"><span style="color:#A6ACCD;">  - main.js          # \uD658\uACBD\uC5D0 \uAD6C\uC560\uBC1B\uC9C0 \uC54A\uB294(Env-agnostic) \uBC94\uC6A9 \uC571 \uCF54\uB4DC\uB85C \uB0B4\uBCF4\uB0B4\uB294(Export) \uC2A4\uD06C\uB9BD\uD2B8</span></span>
<span class="line"><span style="color:#A6ACCD;">  - entry-client.js  # \uC571\uC744 DOM \uC5D8\uB9AC\uBA3C\uD2B8\uC5D0 \uB9C8\uC6B4\uD2B8\uD558\uB294 \uC2A4\uD06C\uB9BD\uD2B8</span></span>
<span class="line"><span style="color:#A6ACCD;">  - entry-server.js  # \uD504\uB808\uC784\uC6CC\uD06C\uC758 SSR API\uB97C \uC0AC\uC6A9\uD574 \uC571\uC744 \uB80C\uB354\uB9C1\uD558\uB294 \uC2A4\uD06C\uB9BD\uD2B8</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p><code>index.html</code>\uC740 <code>entry-client.js</code>\uB97C \uBC18\uB4DC\uC2DC \uCC38\uC870\uD574\uC57C \uD558\uBA70, \uC11C\uBC84\uC5D0\uC11C \uB80C\uB354\uB9C1\uB41C \uD398\uC774\uC9C0\uB97C \uC0BD\uC785\uD574\uC57C \uD558\uB294 \uC790\uB9AC \uD45C\uC2DC\uC790(Placeholder)\uB97C \uD3EC\uD568\uD574\uC57C \uD569\uB2C8\uB2E4:</p><div class="language-html"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">app</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#676E95;font-style:italic;">&lt;!--ssr-outlet--&gt;</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">module</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">src</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/src/entry-client.js</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div><p>\uC815\uD655\uD558\uAC8C \uBC14\uAFC0 \uC218 \uC788\uB2E4\uACE0 \uD310\uB2E8\uB41C\uB2E4\uBA74, <code>&lt;!--ssr-outlet--&gt;</code> \uB300\uC2E0 \uC6D0\uD558\uB294 \uC790\uB9AC \uD45C\uC2DC\uC790\uB97C \uC0AC\uC6A9\uD560 \uC218\uB3C4 \uC788\uC2B5\uB2C8\uB2E4.</p><h2 id="conditional-logic" tabindex="-1">\uC870\uAC74\uBD80 \uB17C\uB9AC <a class="header-anchor" href="#conditional-logic" aria-hidden="true">#</a></h2><p>\uB9CC\uC57D SSR \uB610\uB294 CSR(\uD074\uB77C\uC774\uC5B8\uD2B8 \uCE21 \uB80C\uB354\uB9C1, Client-side Rendering) \uC5EC\uBD80\uC5D0 \uB530\uB77C \uB2E4\uB978 \uCF54\uB4DC\uB97C \uC2E4\uD589\uD558\uACE0\uC790 \uD558\uB294 \uACBD\uC6B0, \uC544\uB798\uC640 \uAC19\uC774 \uC870\uAC74\uBD80 \uB17C\uB9AC \uCF54\uB4DC\uB97C \uC0AC\uC6A9\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4:</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">meta</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">env</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">SSR) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// ... SSR \uC5D0\uC11C\uB9CC \uC791\uB3D9\uD558\uB294 \uCF54\uB4DC</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>\uC774\uB7EC\uD55C \uCF54\uB4DC\uB294 \uBE4C\uB4DC \uC911\uC5D0 \uC815\uC801\uC73C\uB85C \uB300\uCCB4\uB418\uAE30\uC5D0, \uC0AC\uC6A9\uD558\uC9C0 \uC54A\uB294 \uBD84\uAE30\uBB38\uC5D0 \uB300\uD574\uC11C\uB294 \uD2B8\uB9AC-\uC250\uC774\uD0B9*\uC744 \uC801\uC6A9\uD569\uB2C8\uB2E4. (* \uD2B8\uB9AC \uC170\uC774\uD0B9: Tree-shaking, \uC0AC\uC6A9\uD558\uC9C0 \uC54A\uB294 \uCF54\uB4DC\uB97C \uC81C\uAC70\uD558\uB294 \uAE30\uBC95 / <a href="https://webpack.js.org/guides/tree-shaking/" target="_blank" rel="noopener noreferrer">\uCC38\uACE0</a>)</p><h2 id="setting-up-the-dev-server" tabindex="-1">\uAC1C\uBC1C \uC11C\uBC84 \uAD6C\uC131\uD558\uAE30 <a class="header-anchor" href="#setting-up-the-dev-server" aria-hidden="true">#</a></h2><p>SSR \uC571\uC744 \uBE4C\uB4DC\uD560 \uB54C, \uBA54\uC778 \uC11C\uBC84\uB97C \uC644\uC804\uD788 \uC81C\uC5B4\uD558\uACE0 Vite\uB97C \uD504\uB85C\uB355\uC158 \uD658\uACBD\uC5D0\uC11C \uBD84\uB9AC\uD558\uACE0\uC790 \uD55C\uB2E4\uBA74 \uC5B4\uB5BB\uAC8C \uD574\uC57C \uD560\uAE4C\uC694? \uAC00\uC7A5 \uC88B\uC740 \uBC29\uBC95\uC740, Vite\uB97C \uBBF8\uB4E4\uC6E8\uC5B4 \uBAA8\uB4DC\uB85C \uC0AC\uC6A9\uD558\uB294 \uAC83\uC785\uB2C8\uB2E4. \uAC00\uB839 <a href="https://expressjs.com/" target="_blank" rel="noopener noreferrer">Express</a>\uB97C \uC608\uB85C \uB4E4\uC790\uBA74:</p><p><strong>server.js</strong></p><div class="language-js"><span class="copy"></span><div class="highlight-lines"><br><br><br><br><br><br><br><br><br><br><br><br><br><div class="highlighted">\xA0</div><div class="highlighted">\xA0</div><div class="highlighted">\xA0</div><div class="highlighted">\xA0</div><br><br><br><br><br><br><br><br><br><br><br><br><br><br></div><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> fs </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fs</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> path </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">path</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fileURLToPath</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">url</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> express </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">express</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">createServer</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">createViteServer</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">vite</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> __dirname </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dirname</span><span style="color:#A6ACCD;">(</span><span style="color:#82AAFF;">fileURLToPath</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">meta</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">url))</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">createServer</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">app</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">express</span><span style="color:#F07178;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// \uBBF8\uB4E4\uC6E8\uC5B4 \uBAA8\uB4DC\uB85C Vite \uC11C\uBC84\uB97C \uC0DD\uC131\uD558\uACE0 \uC560\uD50C\uB9AC\uCF00\uC774\uC158\uC758 \uD0C0\uC785\uC744 &#39;custom&#39;\uC73C\uB85C \uC124\uC815\uD569\uB2C8\uB2E4.</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// \uC774\uB294 Vite\uC758 \uC790\uCCB4 HTML \uC81C\uACF5 \uB85C\uC9C1\uC744 \uBE44\uD65C\uC131\uD654\uD558\uACE0, \uC0C1\uC704 \uC11C\uBC84\uC5D0\uC11C \uC774\uB97C \uC81C\uC5B4\uD560 \uC218 \uC788\uB3C4\uB85D \uD569\uB2C8\uB2E4.</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">vite</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">createViteServer</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    server</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> middlewareMode</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ssr</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">    appType</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">custom</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// Vite\uB97C \uBBF8\uB4E4\uC6E8\uC5B4\uB85C \uC0AC\uC6A9\uD569\uB2C8\uB2E4.</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// \uB9CC\uC57D Express \uB77C\uC6B0\uD130(express.Router())\uB97C \uC0AC\uC6A9\uD558\uB294 \uACBD\uC6B0, router.use\uB97C \uC0AC\uC6A9\uD574\uC57C \uD569\uB2C8\uB2E4.</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">vite</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">middlewares</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">async</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// index.html \uD30C\uC77C\uC744 \uC81C\uACF5\uD569\uB2C8\uB2E4 - \uC544\uB798\uC5D0\uC11C \uC774\uB97C \uB2E4\uB8F0 \uC608\uC815\uC785\uB2C8\uB2E4.</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">listen</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">5173</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">createServer</span><span style="color:#A6ACCD;">()</span></span>
<span class="line"></span></code></pre></div><p>\uC5EC\uAE30\uC11C\uC758 <code>vite</code>\uB294 <a href="./api-javascript.html#vitedevserver">ViteDevServer</a>\uC758 \uC778\uC2A4\uD134\uC2A4\uC785\uB2C8\uB2E4. <code>vite.middlewares</code>\uB294 <a href="https://github.com/senchalabs/connect" target="_blank" rel="noopener noreferrer">Connect</a> \uC778\uC2A4\uD134\uC2A4\uC774\uBA70, <code>Connect</code>\uB294 \uBBF8\uB4E4\uC6E8\uC5B4\uB85C \uC54C\uB824\uC9C4 \uD50C\uB7EC\uADF8\uC778\uC744 \uC0AC\uC6A9\uD558\uB294 Node.js\uC6A9 HTTP \uC11C\uBC84 \uD504\uB808\uC784\uC6CC\uD06C\uC785\uB2C8\uB2E4.</p><p>\uB2E4\uC74C \uB2E8\uACC4\uB294 \uC11C\uBC84\uC5D0\uC11C \uB80C\uB354\uB9C1\uB41C HTML\uC744 \uC81C\uACF5\uD558\uAE30 \uC704\uD574 <code>*</code> \uD578\uB4E4\uB7EC\uB97C \uAD6C\uD604\uD558\uB294 \uAC83\uC785\uB2C8\uB2E4:</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">app</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">use</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">*</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> res</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> next</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">url</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">req</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">originalUrl</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 1. index.html \uD30C\uC77C\uC744 \uC77D\uC5B4\uB4E4\uC785\uB2C8\uB2E4.</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">template</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">readFileSync</span><span style="color:#F07178;">(</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">path</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">resolve</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">__dirname</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">index.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 2. Vite\uC758 HTML \uBCC0\uD658 \uC791\uC5C5\uC744 \uD1B5\uD574 Vite HMR \uD074\uB77C\uC774\uC5B8\uD2B8\uB97C \uC8FC\uC785\uD558\uACE0,</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//    Vite \uD50C\uB7EC\uADF8\uC778\uC758 HTML \uBCC0\uD658\uB3C4 \uC801\uC6A9\uD569\uB2C8\uB2E4.</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//    (\uC608\uC2DC: @vitejs/plugin-react\uC758 Global Preambles)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">template</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">vite</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">transformIndexHtml</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">template</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 3. \uC11C\uBC84\uC758 \uC9C4\uC785\uC810(Entry)\uC744 \uB85C\uB4DC\uD569\uB2C8\uB2E4.</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//    vite.ssrLoadModule\uC740 Node.js\uC5D0\uC11C \uC0AC\uC6A9\uD560 \uC218 \uC788\uB3C4\uB85D ESM \uC18C\uC2A4 \uCF54\uB4DC\uB97C \uC790\uB3D9\uC73C\uB85C \uBCC0\uD658\uD569\uB2C8\uB2E4.</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//    \uCD94\uAC00\uC801\uC778 \uBC88\uB4E4\uB9C1\uC774 \uD544\uC694\uD558\uC9C0 \uC54A\uC73C\uBA70, HMR\uACFC \uC720\uC0AC\uD55C \uB3D9\uC791\uC744 \uC218\uD589\uD569\uB2C8\uB2E4.</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">render</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">vite</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ssrLoadModule</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/src/entry-server.js</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 4. \uC571\uC758 HTML\uC744 \uB80C\uB354\uB9C1\uD569\uB2C8\uB2E4.</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//    \uC774\uB294 entry-server.js\uC5D0\uC11C \uB0B4\uBCF4\uB0B8(Export) \`render\` \uD568\uC218\uAC00</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//    ReactDOMServer.renderToString()\uACFC \uAC19\uC740 \uC801\uC808\uD55C \uD504\uB808\uC784\uC6CC\uD06C\uC758 SSR API\uB97C \uD638\uCD9C\uD55C\uB2E4\uACE0 \uAC00\uC815\uD569\uB2C8\uB2E4.</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">appHtml</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">render</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">url</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 5. \uB80C\uB354\uB9C1\uB41C HTML\uC744 \uD15C\uD50C\uB9BF\uC5D0 \uC8FC\uC785\uD569\uB2C8\uB2E4.</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">html</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">template</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">replace</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">&lt;!--ssr-outlet--&gt;</span><span style="color:#89DDFF;">\`</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">appHtml</span><span style="color:#F07178;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// 6. \uB80C\uB354\uB9C1\uB41C HTML\uC744 \uC751\uB2F5\uC73C\uB85C \uC804\uC1A1\uD569\uB2C8\uB2E4.</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">res</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">status</span><span style="color:#F07178;">(</span><span style="color:#F78C6C;">200</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">set</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">Content-Type</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">text/html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">end</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">html</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">e</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// \uB9CC\uC57D \uC624\uB958\uAC00 \uBC1C\uC0DD\uB41C\uB2E4\uBA74, Vite\uB294 \uC2A4\uD0DD\uD2B8\uB808\uC774\uC2A4(Stacktrace)\uB97C \uC218\uC815\uD558\uC5EC</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// \uC624\uB958\uAC00 \uC2E4\uC81C \uCF54\uB4DC\uC5D0 \uB9E4\uD551\uB418\uB3C4\uB85D \uC7AC\uAD6C\uC131\uD569\uB2C8\uB2E4.</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">vite</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ssrFixStacktrace</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#82AAFF;">next</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">e</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p><code>package.json</code>\uC758 <code>dev</code> \uC2A4\uD06C\uB9BD\uD2B8\uB3C4 \uC11C\uBC84 \uC2A4\uD06C\uB9BD\uD2B8\uB97C \uC0AC\uC6A9\uD558\uB3C4\uB85D \uBCC0\uACBD\uD574\uC90D\uB2C8\uB2E4:</p><div class="language-diff"><span class="copy"></span><pre><code><span class="line"><span style="color:#A6ACCD;">  &quot;scripts&quot;: {</span></span>
<span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;">   &quot;dev&quot;: &quot;vite&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">+</span><span style="color:#C3E88D;">   &quot;dev&quot;: &quot;node server&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  }</span></span>
<span class="line"></span></code></pre></div><h2 id="building-for-production" tabindex="-1">\uD504\uB85C\uB355\uC158 \uBE4C\uB4DC <a class="header-anchor" href="#building-for-production" aria-hidden="true">#</a></h2><p>SSR \uD504\uB85C\uC81D\uD2B8\uB97C \uD504\uB85C\uB355\uC158\uC73C\uB85C \uC81C\uACF5\uD558\uAE30 \uC704\uD574\uC11C\uB294 \uB2E4\uC74C\uC774 \uD544\uC694\uD569\uB2C8\uB2E4:</p><ol><li>\uD074\uB77C\uC774\uC5B8\uD2B8 \uBE4C\uB4DC\uB97C \uC815\uC0C1\uC801\uC73C\uB85C \uC0DD\uC131\uD569\uB2C8\uB2E4.</li><li>Vite\uC758 <code>ssrLoadModule</code>\uC744 \uAC70\uCE60 \uD544\uC694\uAC00 \uC5C6\uB3C4\uB85D <code>import()</code> \uD568\uC218\uB97C \uD1B5\uD574 \uC9C1\uC811 \uB85C\uB4DC\uD560 \uC218 \uC788\uB294 SSR \uBE4C\uB4DC\uB97C \uC0DD\uC131\uD569\uB2C8\uB2E4.</li></ol><p>\uC774\uB97C \uC704\uD55C <code>package.json</code>\uC758 \uC2A4\uD06C\uB9BD\uD2B8\uB294 \uB2E4\uC74C\uACFC \uAC19\uC2B5\uB2C8\uB2E4:</p><div class="language-json"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">scripts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">dev</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">node server</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">build:client</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">vite build --outDir dist/client</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">build:server</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">vite build --outDir dist/server --ssr src/entry-server.js</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p><code>--ssr</code> \uD50C\uB798\uADF8\uB294 SSR \uBE4C\uB4DC\uC784\uC744 \uC758\uBBF8\uD558\uBA70, SSR\uC758 \uC9C4\uC785\uC810(Entry)\uC774 \uB420 \uC2A4\uD06C\uB9BD\uD2B8\uB97C \uBA85\uC2DC\uD574\uC918\uC57C \uD569\uB2C8\uB2E4.</p><p>\uADF8 \uB2E4\uC74C, <code>server.js</code>\uC5D0\uC11C <code>process.<wbr>env.</code><wbr><code>NODE_ENV</code> \uAC12\uC744 \uD655\uC778\uD558\uC5EC \uC77C\uBD80 \uD504\uB85C\uB355\uC158\uC5D0 \uB300\uD55C \uD2B9\uC815 \uB85C\uC9C1\uC744 \uCD94\uAC00\uD574\uC918\uC57C \uD569\uB2C8\uB2E4:</p><ul><li><p>\uD504\uB85C\uC81D\uD2B8 \uB8E8\uD2B8\uC758 <code>index.html</code> \uD30C\uC77C\uC774 \uC544\uB2CC, <code>dist/client/index.html</code>\uB97C \uD15C\uD50C\uB9BF\uC73C\uB85C \uC0AC\uC6A9\uD558\uB3C4\uB85D \uD569\uB2C8\uB2E4. \uC774 \uD30C\uC77C\uC5D0 \uD074\uB77C\uC774\uC5B8\uD2B8 \uBE4C\uB4DC\uC5D0 \uB300\uD55C \uC62C\uBC14\uB978 \uCC38\uC870\uAC00 \uD3EC\uD568\uB418\uC5B4 \uC788\uAE30 \uB54C\uBB38\uC785\uB2C8\uB2E4.</p></li><li><p><code>await vite.ssrLoadModule(&#39;/src/entry-server.js&#39;)</code> \uB300\uC2E0, <code>import(&#39;./dist/server/entry-server.js&#39;)</code>\uB97C \uC0AC\uC6A9\uD558\uC5EC \uC2A4\uD06C\uB9BD\uD2B8\uB97C \uB85C\uB4DC\uD558\uB3C4\uB85D \uD569\uB2C8\uB2E4. (\uC774 \uD30C\uC77C\uC740 SSR \uBE4C\uB4DC \uACB0\uACFC\uBB3C \uC785\uB2C8\uB2E4.)</p></li><li><p><code>vite</code> \uAC1C\uBC1C \uC11C\uBC84\uC758 \uC0DD\uC131\uACFC \uBAA8\uB4E0 \uC0AC\uC6A9\uC740 \uAC1C\uBC1C \uC804\uC6A9\uC73C\uB85C \uAD6C\uBD84\uB41C \uC870\uAC74\uBB38 \uC544\uB798\uB85C \uC774\uB3D9\uD55C \uB2E4\uC74C, <code>dist/client</code>\uB97C \uD1B5\uD574 \uD30C\uC77C\uC744 \uC81C\uACF5\uD560 \uC218 \uC788\uB3C4\uB85D \uBBF8\uB4E4\uC6E8\uC5B4\uB97C \uCD94\uAC00\uD574\uC90D\uB2C8\uB2E4.</p></li></ul><p>\uC774 <a href="https://github.com/vitejs/vite-plugin-vue/tree/main/playground/ssr-vue" target="_blank" rel="noopener noreferrer">Vue</a> \uBC0F <a href="https://github.com/vitejs/vite-plugin-react/tree/main/playground/ssr-react" target="_blank" rel="noopener noreferrer">React</a> \uB370\uBAA8\uB97C \uCC38\uC870\uD574 \uC790\uC138\uD55C \uD504\uB85C\uC81D\uD2B8 \uAD6C\uC131\uC744 \uD655\uC778\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p><h2 id="generating-preload-directives" tabindex="-1">\uC0AC\uC804 \uB85C\uB4DC\uB420 \uC9C0\uC2DC\uBB38 \uC0DD\uC131\uD558\uAE30 <a class="header-anchor" href="#generating-preload-directives" aria-hidden="true">#</a></h2><p><code>vite build</code>\uB294 \uBE4C\uB4DC \uC2DC <code>ssr-manifest.json</code> \uD30C\uC77C\uC744 \uC0DD\uC131\uD558\uB3C4\uB85D \uD558\uB294 <code>--ssrManifest</code> \uD50C\uB798\uADF8\uB97C \uC9C0\uC6D0\uD569\uB2C8\uB2E4.</p><div class="language-diff"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;">-</span><span style="color:#F07178;"> &quot;build:client&quot;: &quot;vite build --outDir dist/client&quot;,</span></span>
<span class="line"><span style="color:#89DDFF;">+</span><span style="color:#C3E88D;"> &quot;build:client&quot;: &quot;vite build --outDir dist/client --ssrManifest&quot;,</span></span>
<span class="line"></span></code></pre></div><p>\uC704\uC640 \uAC19\uC774 \uAD6C\uC131\uB41C \uC2A4\uD06C\uB9BD\uD2B8\uB294 \uD074\uB77C\uC774\uC5B8\uD2B8 \uBE4C\uB4DC \uC2DC <code>dist/client/ssr-manifest.json</code>\uC744 \uC0DD\uC131\uD569\uB2C8\uB2E4. \uCC38\uACE0\uB85C SSR \uB9E4\uB2C8\uD398\uC2A4\uD2B8 \uD30C\uC77C\uC740 \uBAA8\uB4C8 ID\uB97C \uD074\uB77C\uC774\uC5B8\uD2B8 \uD30C\uC77C\uC5D0 \uB300\uD574 \uB9E4\uD551\uD558\uACE0\uC790 \uD558\uAE30 \uB54C\uBB38\uC5D0, \uD074\uB77C\uC774\uC5B8\uD2B8 \uBE4C\uB4DC\uC5D0\uC11C \uC0DD\uC131\uB429\uB2C8\uB2E4. \uC774 \uB9E4\uB2C8\uD398\uC2A4\uD2B8 \uD30C\uC77C\uC5D0\uB294 \uBAA8\uB4C8 ID\uC640 \uAD00\uB828\uB41C \uCCAD\uD06C \uD30C\uC77C\uC774\uB098 \uC5D0\uC14B \uD30C\uC77C\uC5D0 \uB300\uD55C \uB9E4\uD551\uC774 \uD3EC\uD568\uB418\uC5B4 \uC788\uC2B5\uB2C8\uB2E4.</p><p>\uB9E4\uB2C8\uD398\uC2A4\uD2B8 \uD30C\uC77C\uC744 \uD65C\uC6A9\uD558\uACE0\uC790 \uD55C\uB2E4\uBA74, \uD504\uB808\uC784\uC6CC\uD06C\uB294 \uC11C\uBC84 \uB80C\uB354\uB9C1 \uD638\uCD9C\uC5D0\uC11C \uC0AC\uC6A9\uB41C \uCEF4\uD3EC\uB10C\uD2B8\uC758 \uBAA8\uB4C8 ID\uB97C \uC218\uC9D1\uD558\uB294 \uBC29\uBC95\uC744 \uC81C\uACF5\uD574\uC57C \uD569\uB2C8\uB2E4.</p><p><code>@vitejs/plugin-vue</code>\uB294 \uC774\uB97C \uC774\uBBF8 \uC9C0\uC6D0\uD558\uACE0 \uC788\uC73C\uBA70, \uC0AC\uC6A9\uB41C \uCEF4\uD3EC\uB10C\uD2B8\uC758 \uBAA8\uB4C8 ID\uB97C \uC5F0\uACB0\uB41C Vue SSR \uCEE8\uD14D\uC2A4\uD2B8\uC5D0 \uC790\uB3D9\uC73C\uB85C \uB4F1\uB85D\uD558\uB3C4\uB85D \uD569\uB2C8\uB2E4:</p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#676E95;font-style:italic;">// src/entry-server.js</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> ctx </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{}</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> html </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#A6ACCD;"> vueServerRenderer</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">renderToString</span><span style="color:#A6ACCD;">(app</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> ctx)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// ctx.modules\uB294 \uC774\uC81C \uB80C\uB354\uB9C1 \uC911\uC5D0 \uC0AC\uC6A9\uB41C \uBAA8\uB4C8 ID\uC758 \uC9D1\uD569(Set)\uC785\uB2C8\uB2E4.</span></span>
<span class="line"></span></code></pre></div><p><code>server.js</code>\uC758 \uD504\uB85C\uB355\uC158 \uBD84\uAE30\uBB38\uC5D0\uC11C\uB294 \uB9E4\uB2C8\uD398\uC2A4\uD2B8 \uD30C\uC77C\uC744 \uC77D\uACE0, <code>src/entry-server.js</code>\uC5D0\uC11C \uB0B4\uBCF4\uB0B8(Export) <code>render</code> \uD568\uC218\uC5D0 \uC804\uB2EC\uD574\uC57C \uD569\uB2C8\uB2E4. \uC774\uB294 \uBE44\uB3D9\uAE30 \uB77C\uC6B0\uD305\uC5D0\uC11C \uC0AC\uC6A9\uB418\uB294 \uD30C\uC77C\uC5D0 \uB300\uD55C \uC0AC\uC804 \uB85C\uB4DC \uC9C0\uC2DC\uBB38(Directives)\uC744 \uB80C\uB354\uB9C1\uD558\uAE30\uC5D0 \uCDA9\uBD84\uD55C \uC815\uBCF4\uB97C \uC81C\uACF5\uD569\uB2C8\uB2E4. \uC804\uCCB4 \uC608\uC81C\uB294 <a href="https://github.com/vitejs/vite-plugin-vue/blob/main/playground/ssr-vue/src/entry-server.js" target="_blank" rel="noopener noreferrer">\uB370\uBAA8 \uC18C\uC2A4 \uCF54\uB4DC</a>\uB97C \uCC38\uACE0\uD574\uC8FC\uC138\uC694.</p><h2 id="pre-rendering-ssg" tabindex="-1">\uC0AC\uC804 \uB80C\uB354\uB9C1 / SSG <a class="header-anchor" href="#pre-rendering-ssg" aria-hidden="true">#</a></h2><p>\uB9CC\uC57D \uC5B4\uB5A4 \uB77C\uC6B0\uD2B8\uC5D0 \uD544\uC694\uD55C \uACBD\uB85C\uC640 \uB370\uC774\uD130\uB97C \uBBF8\uB9AC \uC54C\uACE0 \uC788\uB294 \uACBD\uC6B0, \uD504\uB85C\uB355\uC158 SSR\uACFC \uB3D9\uC77C\uD55C \uB85C\uC9C1\uC744 \uC0AC\uC6A9\uD558\uC5EC \uC774\uB97C \uC815\uC801 HTML \uD30C\uC77C\uB85C \uBBF8\uB9AC \uB80C\uB354\uB9C1\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4. \uC774\uB294 SSG(\uC815\uC801 \uC0AC\uC774\uD2B8 \uC0DD\uC131, Static-Site Generation)\uC758 \uD55C \uD615\uD0DC\uB85C \uC0DD\uAC01\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4. \uB3D9\uC791\uD558\uB294 \uC608\uC81C\uB294 <a href="https://github.com/vitejs/vite-plugin-vue/blob/main/playground/ssr-vue/prerender.js" target="_blank" rel="noopener noreferrer">\uC0AC\uC804 \uB80C\uB354\uB9C1 \uB370\uBAA8 \uC2A4\uD06C\uB9BD\uD2B8</a>\uB97C \uCC38\uACE0\uD574\uC8FC\uC138\uC694.</p><h2 id="ssr-externals" tabindex="-1">SSR \uC678\uBD80\uD654 <a class="header-anchor" href="#ssr-externals" aria-hidden="true">#</a></h2><p>SSR\uC744 \uC2E4\uD589\uD560 \uB54C \uB514\uD39C\uB358\uC2DC\uB294 \uAE30\uBCF8\uC801\uC73C\uB85C Vite\uC758 SSR \uBCC0\uD658 \uBAA8\uB4C8 \uC2DC\uC2A4\uD15C\uC5D0\uC11C &quot;\uC678\uBD80\uD654(Externalized)&quot;\uB429\uB2C8\uB2E4. \uC774\uB294 \uAC1C\uBC1C \uBC0F \uBE4C\uB4DC \uC18D\uB3C4\uB97C \uBAA8\uB450 \uD5A5\uC0C1\uC2DC\uD0B5\uB2C8\uB2E4.</p><p>\uB9CC\uC57D \uD2B9\uC815 \uB514\uD39C\uB358\uC2DC\uAC00 \uC678\uBD80\uD654\uB97C \uC218\uD589\uD558\uC9C0 \uC54A\uAE30\uB97C \uC6D0\uD55C\uB2E4\uBA74 <a href="./../config/ssr-options.html#ssr-noexternal"><code>ssr.noExternal</code></a> \uBAA9\uB85D\uC5D0 \uCD94\uAC00\uD574\uC8FC\uC138\uC694.</p><p>\uC5F0\uACB0\uB41C \uB514\uD39C\uB358\uC2DC\uC758 \uACBD\uC6B0, \uAE30\uBCF8\uC801\uC73C\uB85C Vite\uC758 HMR\uC744 \uD65C\uC6A9\uD558\uAE30 \uC704\uD574 \uC678\uBD80\uD654\uB418\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4. \uB9CC\uC57D \uD14C\uC2A4\uD2B8\uB97C \uC704\uD574 \uB514\uD39C\uB358\uC2DC\uAC00 \uC5F0\uACB0\uB418\uC9C0 \uC54A\uC740 \uAC83\uCC98\uB7FC \uAD6C\uC131\uD558\uACE0\uC790 \uD55C\uB2E4\uBA74 <a href="./../config/ssr-options.html#ssr-external"><code>ssr.external</code></a>\uC5D0 \uB514\uD39C\uB358\uC2DC\uB97C \uCD94\uAC00\uD574\uC8FC\uC138\uC694.</p><div class="warning custom-block"><p class="custom-block-title">\uBCC4\uCE6D\uC744 \uC0AC\uC6A9\uD558\uB294 \uACBD\uC6B0</p><p>\uB9CC\uC57D \uC5B4\uB5A4 \uD558\uB098\uC758 \uD328\uD0A4\uC9C0\uB97C \uB2E4\uB978 \uD328\uD0A4\uC9C0\uB97C \uB9AC\uB2E4\uC774\uB809\uD2B8\uD558\uB294 \uBCC4\uCE6D\uC744 \uC0AC\uC6A9\uD558\uB294 \uACBD\uC6B0, \uC678\uBD80\uD654\uB41C SSR \uB514\uD39C\uB358\uC2DC\uC5D0\uC11C\uB3C4 \uC0AC\uC6A9\uD560 \uC218 \uC788\uB3C4\uB85D <code>node_modules</code> \uD328\uD0A4\uC9C0\uC5D0 \uBCC4\uCE6D\uC744 \uC9C0\uC815\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4. <a href="https://classic.yarnpkg.com/en/docs/cli/add/#toc-yarn-add-alias" target="_blank" rel="noopener noreferrer">Yarn</a>\uACFC <a href="https://pnpm.js.org/en/aliases" target="_blank" rel="noopener noreferrer">pnpm</a> \uBAA8\uB450 <code>npm:</code> \uC811\uB450\uC0AC\uB97C \uC0AC\uC6A9\uD558\uC5EC \uBCC4\uCE6D\uC744 \uC9C0\uC815\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p></div><h2 id="ssr-specific-plugin-logic" tabindex="-1">SSR \uC804\uC6A9 \uD50C\uB7EC\uADF8\uC778 \uB85C\uC9C1 <a class="header-anchor" href="#ssr-specific-plugin-logic" aria-hidden="true">#</a></h2><p>Vue \uB610\uB294 Svelte\uC640 \uAC19\uC740 \uC77C\uBD80 \uD504\uB808\uC784\uC6CC\uD06C\uB294 \uD074\uB77C\uC774\uC5B8\uD2B8 \uB610\uB294 SSR\uC5D0 \uB530\uB77C \uCEF4\uD3EC\uB10C\uD2B8\uB97C \uB2E4\uB978 \uD615\uC2DD\uC73C\uB85C \uCEF4\uD30C\uC77C\uD569\uB2C8\uB2E4. \uC774 \uC870\uAC74\uBD80 \uBCC0\uD658\uC744 \uC9C0\uC6D0\uD558\uAE30 \uC704\uD574, Vite\uB294 <code>options</code> \uAC1D\uCCB4\uC5D0 \uC874\uC7AC\uD558\uB294 <code>ssr</code> \uC774\uB77C\uB294 \uCD94\uAC00\uC801\uC778 \uC778\uC218\uB97C \uC544\uB798\uC758 \uD50C\uB7EC\uADF8\uC778 \uD6C5(Hook)\uC5D0 \uC804\uB2EC\uD569\uB2C8\uB2E4:</p><ul><li><code>resolveId</code></li><li><code>load</code></li><li><code>transform</code></li></ul><p><strong>\uC608\uC81C:</strong></p><div class="language-js"><span class="copy"></span><pre><code><span class="line"><span style="color:#89DDFF;font-style:italic;">export</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">mySSRPlugin</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    name</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">my-ssr</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    transform</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">code</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">id</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">options</span><span style="color:#89DDFF;">)</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">options</span><span style="color:#89DDFF;">?.</span><span style="color:#A6ACCD;">ssr</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// SSR\uC778 \uACBD\uC6B0\uC5D0\uB9CC \uC218\uD589\uB420 \uBCC0\uD658 \uC791\uC5C5 \uAD00\uB828 \uCF54\uB4DC\uB4E4...</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p><code>load</code>\uC640 <code>transform</code> \uBA54\uC11C\uB4DC\uC758 \uC635\uC158 \uAC1D\uCCB4\uB294 \uC5B4\uB514\uAE4C\uC9C0\uB098 \uC120\uD0DD \uC0AC\uD56D\uC77C \uBFD0\uC785\uB2C8\uB2E4. \uD604\uC7AC Rollup\uC5D0\uC11C \uC774 \uAC1D\uCCB4\uB97C \uC0AC\uC6A9\uD558\uC9C0\uB294 \uC54A\uC73C\uB098, \uD5A5\uD6C4 \uBA54\uD0C0\uB370\uC774\uD130\uB85C \uC774\uB97C \uD655\uC7A5\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p><div class="tip custom-block"><p class="custom-block-title">\uCC38\uACE0</p><p>Vite 2.7 \uC774\uC804\uC5D0\uB294 <code>options</code> \uAC1D\uCCB4\uB97C \uC0AC\uC6A9\uD558\uB294 \uB300\uC2E0 <code>ssr</code> \uB9E4\uAC1C\uBCC0\uC218\uB97C \uC774\uC6A9\uD588\uC2B5\uB2C8\uB2E4. \uB530\uB77C\uC11C \uC774\uC640 \uAD00\uB828\uB41C \uBAA8\uB4E0 \uD504\uB808\uC784\uC6CC\uD06C\uC640 \uD50C\uB7EC\uADF8\uC778\uC774 \uC5C5\uB370\uC774\uD2B8 \uB420 \uAC83\uC774\uC9C0\uB9CC, \uAC04\uD639 \uC774\uC804 API\uB97C \uC774\uC6A9\uD558\uB294 \uACBD\uC6B0\uB97C \uB9C8\uC8FC\uD560 \uC218\uB3C4 \uC788\uC2B5\uB2C8\uB2E4.</p></div><h2 id="ssr-target" tabindex="-1">SSR \uD0C0\uAC9F <a class="header-anchor" href="#ssr-target" aria-hidden="true">#</a></h2><p>\uAE30\uBCF8\uC801\uC73C\uB85C SSR \uBE4C\uB4DC \uD0C0\uAC9F\uC740 Node \uD658\uACBD\uC774\uC9C0\uB9CC, \uC6F9 \uC6CC\uCEE4\uB97C \uD1B5\uD574 \uC11C\uBC84\uB97C \uC2E4\uD589\uD560 \uC218\uB3C4 \uC788\uC2B5\uB2C8\uB2E4. \uD328\uD0A4\uC9C0\uB4E4\uC758 \uC9C4\uC785\uC810(Entry)\uC740 \uD50C\uB7AB\uD3FC \uBCC4 \uB2E4\uB985\uB2C8\uB2E4. <code>ssr.target</code>\uB97C <code>&#39;webworker&#39;</code>\uB85C \uC124\uC815\uD558\uBA74 Web Worker\uB97C \uD1B5\uD574 \uC11C\uBC84\uB97C \uC2E4\uD589\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p><h2 id="ssr-bundle" tabindex="-1">SSR \uBC88\uB4E4 <a class="header-anchor" href="#ssr-bundle" aria-hidden="true">#</a></h2><p>\uD2B9\uC815 <code>webworker</code>\uC640 \uAC19\uC740 \uB7F0\uD0C0\uC784\uC5D0\uC11C, \uD558\uB098\uC758 JavaScript \uD30C\uC77C\uB85C SSR \uBE4C\uB4DC\uB97C \uBC88\uB4E4\uB9C1\uD558\uACE0\uC790 \uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4. \uC774\uB294 <code>ssr.noExternal</code>\uC744 <code>true</code>\uB85C \uC124\uC815\uD574 \uAC00\uB2A5\uD558\uBA70, \uC544\uB798\uC758 \uB450 \uAC00\uC9C0 \uB3D9\uC791\uC744 \uC218\uD589\uD569\uB2C8\uB2E4.</p><ul><li>\uBAA8\uB4E0 \uB514\uD39C\uB358\uC2DC\uB97C <code>noExternal</code>\uB85C \uCC98\uB9AC\uD569\uB2C8\uB2E4.</li><li>Node.js \uB0B4\uC7A5(Built-ins) \uAE30\uB2A5\uC744 \uAC00\uC838\uC624\uBA74 \uC624\uB958\uAC00 \uBC1C\uC0DD\uB429\uB2C8\uB2E4.</li></ul><h2 id="vite-cli" tabindex="-1">Vite CLI <a class="header-anchor" href="#vite-cli" aria-hidden="true">#</a></h2><p><code>$ vite dev</code> \uBC0F <code>$ vite preview</code> CLI \uBA85\uB839\uB3C4 SSR \uC560\uD50C\uB9AC\uCF00\uC774\uC158\uC5D0 \uB300\uD574 \uC0AC\uC6A9\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4. SSR \uBBF8\uB4E4\uC6E8\uC5B4\uB294 <a href="/guide/api-plugin.html#configureserver"><code>configureServer</code></a>\uB97C \uC0AC\uC6A9\uD574 \uAC1C\uBC1C \uC11C\uBC84\uC5D0, \uADF8\uB9AC\uACE0 <a href="/guide/api-plugin.html#configurepreviewserver"><code>configurePreviewServer</code></a>\uB97C \uC0AC\uC6A9\uD574 \uD504\uB9AC\uBDF0 \uC11C\uBC84\uC5D0 \uCD94\uAC00\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.</p><div class="tip custom-block"><p class="custom-block-title">\uCC38\uACE0</p><p>SSR \uBBF8\uB4E4\uC6E8\uC5B4\uAC00 Vite \uBBF8\uB4E4\uC6E8\uC5B4 <em>\uC774\uD6C4\uC5D0</em> \uC2E4\uD589\uB418\uAE30\uB97C \uC6D0\uD55C\uB2E4\uBA74 \uD3EC\uC2A4\uD2B8 \uD6C5\uC744 \uC0AC\uC6A9\uD558\uC138\uC694.</p></div><h2 id="ssr-format" tabindex="-1">SSR Format <a class="header-anchor" href="#ssr-format" aria-hidden="true">#</a></h2><p>By default, Vite generates the SSR bundle in ESM. There is experimental support for configuring <code>ssr.format</code>, but it isn&#39;t recommended. Future efforts around SSR development will be based on ESM, and CommonJS remain available for backward compatibility. If using ESM for SSR isn&#39;t possible in your project, you can set <code>legacy.buildSsrCjsExternalHeuristics: true</code> to generate a CJS bundle using the same <a href="https://v2.vitejs.dev/guide/ssr.html#ssr-externals" target="_blank" rel="noopener noreferrer">externalization heuristics of Vite v2</a>.</p>`,67),o=[p];function t(r,c,i,y,F,D){return a(),n("div",null,o)}var C=s(e,[["render",t]]);export{A as __pageData,C as default};
